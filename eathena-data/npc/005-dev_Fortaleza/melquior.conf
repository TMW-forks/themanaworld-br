//
// Criado por Fafinha - TMW-BR
// Quest Set Dragão Parte 1

005-dev.gat,101,88,0	script	desfazerMelquior	155,{
	set QUEST_luvasDragao_dev, 0;
	mes "A quest do Melquior já pode ser refeita.";
	npctalk "* "+strcharinfo(0)+" desfez a quest do Melquior.";
	close;
}

005-dev.gat,101,85,0	script	Melquior	159,{
	if (QUEST_luvasDragao_dev == 1) goto _emCurso;
	if (QUEST_luvasDragao_dev == 2) goto _voltando;
	if (QUEST_luvasDragao_dev == 3) goto _sucesso;
	if (QUEST_luvasDragao_dev >= 4) goto _finalizado;

	mes "[Melquior]";
	mes "\"Quem aquele Agostine pensa que é!";
	mes "Eu sim sou o melhor alfaiate do mundo!\"";
	next;

	mes "[Melquior]";
	mes "\"Olá estranho, em que posso ajudá-lo?\"";
	next;
	menu
		"O que você tem contra o Agostine.", _agostine,
		"Por quê você se acha o melhor alfaiate do mundo?", _expSet,
		"Nada não, obrigado.", -;
	close;

_agostine:
	mes "[Melquior]";
	mes "Com uma cara de raiva.";
	next;
	
	mes "[Melquior]";
	mes "\"Ahhh ... aquele infeliz anda dizendo para todo mundo que ele é o melhor alfaiate do mundo e que cria as melhores roupas.";
	mes "Isso não passa de uma grande mentira!";
	mes "Eu sim, sei criar uma armadura, que deixaria qualquer um de queixo caído.\"";
	next;
	menu
		"Que armadura é essa?", _expSet,
		"Uhm, agora entendi sua raiva.", -;
	close;

_expSet:
	mes "[Melquior]";
	mes "\"Eu sei criar um item, que definidamente, é o melhor que já se viu.";
	mes "Durante anos procurei por um material, que fosse ao mesmo tempo resistente e maleável.";
	mes "Finalmente encontrei a um tempo atrás, quando criaturas sinistras invadiram as terras das Fadas.";
	mes "Com muita dificuldade, consegui matar algumas e retirar delas suas escamas.\"";
	next;
	mes "[Melquior]";
	mes "\"Infelizmente é preciso ter cuidado na hora de retirar suas escamas, para não estragá-las.\"";
	next;

	mes "[Melquior]";
	mes "\"Se você quiser posso lhe criar este precioso item!\"";
	menu;
	menu
		"Opa! É claro que eu quero!", _itensSet,
		"Não, obrigado.", -;
	close;

_itensSet:
	mes "[Melquior]";
	mes "\"Muito bem! Mas primeiro eu preciso que você me traga algumas escamas em bom estado.";
	mes "Você aceita está tarefa?\"";
	next;
	menu
		"Mas é claro que sim!", _aceito,
		"Pensando bem, acho melhor não.", _negado;

_aceito:
	mes "[Melquior]";
	mes "Com uma cara mais alegre.";
	mes "\"Muito bem, nobre cavaleiro!";
	mes "Lembre-se de que preciso das escamas em bom estado.";
	mes "Boa sorte!\"";
	set QUEST_luvasDragao_dev, 1;
	close;

_negado:
	mes "[Melquior]";
	mes "\"Você é quem sabe.";
	mes "Se mudar de idéia, volte.\"";
	set QUEST_luvasDragao_dev, 2;
	close;

_emCurso:
	mes "[Melquior]";
	mes "\"Ohh! Você voltou. Conseguiu aquilo que lhe pedi?\"";
	next;
	menu
		"Sim, aqui está!", _verificarItens,
		"Ainda não!", -;
	close;

_voltando:
	mes "[Melquior]";
	mes "\"Olá! Você voltou.";
	mes "Pensou melhor na minha proposta?\"";
	next;
	menu
		"Acho que ainda não estou pronto.", -,
		"Sim, estou preparado agora!", _aceito;
	close;

_verificarItens:
	mes "[Melquior]";
	mes "\"Mmm ... vamos ver ...\"";
	next;
	if (countitem("escamasDragao") < 1) goto _semItem;
	delitem "escamasDragao", 1;
	set @Temp1,rand(15);
	if (@Temp1 == 0) goto _sucesso;
	mes "[Melquior]";
	mes "Melquior, desapontado, joga fora aquelas escamas.";
	next;
	mes "[Melquior]";
	mes "\"Eu lhe disse para ter cuidado!\"";
	if (countitem("escamasDragao") < 1) goto _semItem;
	next;
	menu
		"Espere! Eu tenho mais.", _verificarItens,
		"Vou ter mais cuidado.", -;
	close;

_semItem:
	mes "[Melquior]";
	mes "\"Você não tem escamas.";
	mes "Volte quando tiver mais.\"";
	close;

_sucesso:
	mes "[Melquior]";
	mes "Melquior ri de felicidade";
	next;
	mes "[Melquior]";
	mes "\"Muito bem! Começarei o trabalho agora mesmo.\"";
	set QUEST_luvasDragao_dev, 3;
	next;
	goto _preco;

_preco:
	mes "[Melquior]";
	mes "\"Meu amigo, como você deve saber, nada neste mundo é de graça.";
	mes "Por isso, para que eu continue o meu trabalho, eu preciso que você me pague uma pequena taxa de serviço. São míseros 30.000 GP.\"";
	next;
	menu
		"Tu tá maluco! Sai fora!", -,
		"Tss, muito caro para mim.", -,
		"Vou pagar o seu preço!", _pagamento;
	close;

_pagamento:
	if (zeny < 30000) goto _semGrana;
	getinventorylist;
	if (@inventorylist_count == 100) goto _inventFull;
	set zeny, zeny - 30000;
	getitem "luvasDragao", 1;
	set QUEST_luvasDragao_dev, 4;
	mes "[Melquior]";
	mes "\"Aqui está, esse é um dos melhores trabalhos!\"";
	close;

_semGrana:
	mes "[Melquior]";
	mes "\"Você não tem dinheiro o suficiente para me pagar.";
	mes "Volte quando tiver o meu dinheiro.\"";
	close;

_finalizado:
	mes "[Melquior]";
	mes "\"Espero que o item que lhe fiz esteja sendo útil.\"";
	close;

_inventFull:
	mes "[Melquior]";
	mes "\"Você não tem espaço para este novo item.\"";
	close;
}
