///////////////////////////////////////////////////////////////////
//  IDE: TMW-Maker v0.2
//  MODIFICADO: 21/10/2010 12:04 AM
///////////////////////////////////////////////////////////////////

navio-1.gat,24,23,0	script	Capitão Mirc	303,{
///////////////////////////////////////////////////////////////////
//  PROGRAMADOR: Lunovox
//  ACRIAÇÃO: 20/10/2010 10:32 PM
//  UTILIDADE DO SCRIPT:
//    * Capitão que controla a cidade de destino do navio.
///////////////////////////////////////////////////////////////////
_inicio:
     setarray @Cidade$,
       "Porto da Vila dos Pescadores",
       "Porto do Polo Norte",
       "Porto de Hades",
       "Porto de Halicarnaso em Manaland";
     setarray @Distancia, 2,3,4,5; // Distancia em Minutos
     setarray @Custo, 5000,9000,0,0; //Custo 0(GP) = Porto Impedido

     mes "[Capitão Mirc]";
     if(Sex==1) mes "\"Olá meu jovem!\"";
     if(Sex==0) mes "\"Olá minha jovem!\"";
     next;
     if(SeTrabalhaNoNavio==1) goto _TrazCaldas;
     if(PortoAtracado==-1) goto _Altomar;
_PerguntaBase:
     mes "[Capitão Mirc]";
     mes "\"Deseja viajar para alguma cidade?\"";
     next;
     mes "["+ strcharinfo(0) +"]";
     menu
       "Sim! Quero viajar!", _EscolherDestino,
       "Quanto Custa?", _Custo,
       "Não! Obrigado!", -;
_Desistencia:
     mes "[Capitão Mirc]";
     mes "\"Ok! Fique a vontade para voltar quando desejar\"";
close;

_Custo:
     mes "[Capitão Mirc]";
     mes "Retira dou bolço um papel com algo escrito.";
     next;
     mes "[PASSAGEM DE NAVIO]";
     if(@Custo[0]>0) mes "* "+@Cidade$[0] +"\: "+@Custo[0]+"GP";
     if(@Custo[1]>0) mes "* "+@Cidade$[1] +"\: "+@Custo[1]+"GP";
     if(@Custo[2]>0) mes "* "+@Cidade$[2] +"\: "+@Custo[2]+"GP";
     if(@Custo[3]>0) mes "* "+@Cidade$[3] +"\: "+@Custo[3]+"GP";
     //mes " OBS: Os porto com custo 0(zero) estão impedidos.\"";
     next;
goto _PerguntaBase;

_EscolherDestino:
     mes "["+ strcharinfo(0) +"]";
     mes "\"Meu destino será:\"";
     menu
       "Eu ficarei aqui mesmo.", -,
       " * "+ @Cidade$[0], -,
       " * "+ @Cidade$[1], -,
       " * "+ @Cidade$[2], -,
       " * "+ @Cidade$[3], -;
       if(@menu==0 || @menu==1) goto _Desistencia;
       if(@Custo[@menu-2]>=1) set PortoDesejado,@menu-2;
       if(@Custo[@menu-2]>=1) goto _PortoDesatracar;
       if(@Custo[@menu-2]<=0) goto _PortoImpedido;
goto _Desistencia;


_SemGrana:
     mes "[Capitão Mirc]";
     mes "\"Pena que você não tem dinheiro suficiente.\"";
     if(BaseLevel < 30) close;
     next;
     mes "[Capitão Mirc]";
     mes "\"Mas se você aceitar pode viajar comigo se aceitar trabalhar para mim como ajudante.\"";
     next;
     mes "["+ strcharinfo(0) +"]";
     menu
       "O que eu preciso fazer?", -,
       "Não quero, obrigado!", _Desistencia;
goto _InteressePeloTrabalho;

_SemCaldas:
     mes "[Capitão Mirc]";
     mes "\"Você ainda não matou todos os ratos que eu mandei? Vá logo!";
     mes "E só volte quando tiver as 30 caldas de ratos como prova!\"";
close;

_InteressePeloTrabalho:
     mes "[Capitão Mirc]";
     mes "\"Só precisa que fique matando os ratos que ficam comendo toda a comida do convés.\"";
     next;
     next;
     mes "[Capitão Mirc]";
     mes "\"Para provar que você está trabalhando direitinho, quero que você consiga pelo menos 30 caldas destes de ratos para mim.\"";
     next;
     mes "["+ strcharinfo(0) +"]";
     menu
       "Ok! Eu aceito!", _AceitaTrabalho,
       "Não! Obrigado!", _Desistencia;
goto _Desistencia;

_AceitaTrabalho:
     set SeTrabalhaNoNavio,1;
     set PortoAtracado,-1;
     savepoint "navio-2.gat",28,23;
     mes "[Capitão Mirc]";
     mes "\"Ok Marujo! Mãos a obra! Vamos viajar com este navio com toda a força dos ventos. "+
         "Não quero ver sua cara enquanto não conseguir o que lhe mandei!\"";
close;

_TrazCaldas:
     mes "[Capitão Mirc]";
     mes "\"Trouxe as 30 caldas de rato que eu mandei?\"";
     next;
     mes "["+ strcharinfo(0) +"]";
     menu
       "Sim! Estão aqui!", _PortoDesatracar,
       "Não! Prefiro pagar!", _PortoDesatracar,
       "Não! Falta pouco!", _SemCaldas;
goto _PortoDesatracar;

_PortoImpedido:
     mes "[Capitão Mirc]";
     mes "\"Esse porto foi trancado e está impedido a entrada de navio. Desculpe!\"";
     next;
goto _EscolherDestino;

_PortoAtracado:
     mes "[Capitão Mirc]";
     mes "\"Já estamos atracados ao "+ @Cidade$[PortoAtracado] +".\"";
     next;
goto _EscolherDestino;

_PortoDesatracar:
     if(PortoAtracado==PortoDesejado) goto _PortoAtracado;
// correção temporária para que ninguém fique preso.
     //if(SeTrabalhaNoNavio!=1 && Zeny<@Custo[PortoDesejado]) goto _SemGrana;
     //if(SeTrabalhaNoNavio==1 && countitem(3169)<30) goto _SemCaldas;
     //if(SeTrabalhaNoNavio!=1) set Zeny, Zeny-@Custo[PortoDesejado];
     //if(SeTrabalhaNoNavio==1) delitem 3169,30;
//--------------------------------------------------
     callfunc "getTime";
     set EsperaAoPorto, @time + (@Distancia[PortoDesejado]*60);
     if(SeTrabalhaNoNavio==1) mes "[Capitão Mirc]";
     if(SeTrabalhaNoNavio==1) mes "\"Bom tabalho!!!\"";
     if(SeTrabalhaNoNavio==1) next;
     if(SeTrabalhaNoNavio==0) mes "[Capitão Mirc]";
     if(SeTrabalhaNoNavio==0) mes "\"Sairemos com o navio em instantes.\"";
     if(SeTrabalhaNoNavio==0) next;
     set SeTrabalhaNoNavio,0;
     set PortoAtracado,-1;
     set ContTempViagem,0;
     //callfunc "Guarda do Navio#vigia::_iniciaVigilancia";
     mes "[Capitão Mirc]";
     mes "\"Vá curtir o passeio, pois logo-logo chegaremos ao "+ @Cidade$[PortoDesejado] +"!\"";
close;

_Altomar:
	callfunc "getTime";
	if(EsperaAoPorto>@time) goto _NaoAtracado;
	set PortoAtracado,PortoDesejado;
	mes "[Capitão Mirc]";
	mes "\"Acabamos de atracar ao "+ @Cidade$[PortoDesejado] +". Espero que tenha gostado a viagem!\"";
close;

_NaoAtracado:
     mes "[Capitão Mirc]";
     mes "\"Ainda não chegamos ao "+ @Cidade$[PortoDesejado] +". "+
     "Passaremos por alguns locais primeiros, mas logo-logo chegaremos ao "+ @Cidade$[PortoDesejado] +".\"";
close;

}
