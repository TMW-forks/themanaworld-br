///////////////////////////////////////////////////////////////////
//  IDE: TMW-Maker v0.2
//  MODIFICADO: 01/01/2011 10:30 AM
///////////////////////////////////////////////////////////////////

005-3.gat,46,146,0	script	Seu Agirrab	322,{
///////////////////////////////////////////////////////////////////
//  PROGRAMADOR: Lunovox
//  ACRIAÇÃO: 01/01/2011 8:04 AM
//  UTILIDADE DO SCRIPT:
//    * Aluga por 20kGP um dos quartos de pensão que foi 
//      escolhido pelo player por 24h úteis.
///////////////////////////////////////////////////////////////////
_inicio:

_configurar:
	set @MaxQuartos, 29;
	set @SegAlugados, 24*60*60;
	//set @SegAlugados, 2*60;

	if($PB_Custo >= 1) goto _configurado;
	set Agirrab_Capitulo, 0;
	set $PB_Custo, 20000;
	set $PB_Ocupados, 0;
	setarray $PB_Inquilinos$, 
	"", "", "", "", "", "", "", "", "", "", 
	"", "", "", "", "", "", "", "", "", "", 
	"", "", "", "", "", "", "", "", "";
	setarray $PB_Senha$, 
	"", "", "", "", "", "", "", "", "", "", 
	"", "", "", "", "", "", "", "", "", "", 
	"", "", "", "", "", "", "", "", "";
	setarray $PB_Vencimentos, 
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
	0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
	0, 0, 0, 0, 0, 0, 0, 0, 0;
	//mes "[AgirrabCap="+ Agirrab_Capitulo +"] [Custo="+ $PB_Custo +"] [QuartosOcupados="+ $PB_Ocupados +"]";

//----------------------------------------------------------------------------------------------------------------
_configurado:
	//if(Agirrab_Capitulo==1 && $PB_Ocupados >= @MaxQuartos) goto _sem_vagas;		
	//if(Agirrab_Capitulo==1 && $PB_Ocupados < @MaxQuartos) goto _pergunta;
	if(Agirrab_Capitulo==0) goto _apresentacao;	
goto _pergunta;	
//----------------------------------------------------------------------------------------------------------------

_apresentacao:
	mes "[Seu Agirrab]";
	mes "\"Olá "+ strcharinfo(0) +"! "+
	    "Eu possuo uma grande pensão aqui na ilha. "+
	    "Você quer alugar um quarto?\"";
	next;
	mes "["+ strcharinfo(0) +"]";
	mes "\"Eu não preciso disso. "+
		"Para que eu vou querer uma quarto?\"";
	next;
	mes "[Seu Agirrab]";
	mes "\"Poderá fazer reuniões com seus amigos em uma sala trancada por uma senha de sua escolha."+
		"Poderá guardar seus itens e seu dinheiro sem pagar nada adicional.\"";
	next;
	set Agirrab_Capitulo, 1;
goto _pergunta;

_sem_vagas:
	mes "[Seu Agirrab]";
	mes "\"A Pensão Bhramir esté sem vagas até o momento. Venha me procurar mais tarde!\"";
	next;
	mes "[Seu Agirrab]";
	mes "\"Mesmo assim, deseja ver a lista dos locatários?\"";
	next;
	mes "["+ strcharinfo(0) +"]";
	menu
	"Quero sim.", _listarLocatarios,
	"Não estou precisando.", _nao_precisa;
goto _nao_precisa;

_pergunta:
	mes "[Seu Agirrab]";
	mes "\"Você quer alugar um quarto por "+ $PB_Custo +"GP durante "+ (@SegAlugados/(60*60)) +" horas uteis?\"";
	next;
	mes "["+ strcharinfo(0) +"]";
	menu
	"Quero sim.", _listarLocatarios,
	"Não estou precisando.", _nao_precisa;
goto _nao_precisa;


_listarLocatarios:
	callfunc "getTime";
	mes "[LISTA DE LOCATÁRIOS]";
	menu
	"001 "+$PB_Inquilinos$[0]+" (" +(($PB_Vencimentos[0]-@time)/60) +"min)", -,
	"002 "+$PB_Inquilinos$[1]+" (" +(($PB_Vencimentos[1]-@time)/60) +"min)", -,
	"003 "+$PB_Inquilinos$[2]+" (" +(($PB_Vencimentos[2]-@time)/60) +"min)", -,
	"004 "+$PB_Inquilinos$[3]+" (" +(($PB_Vencimentos[3]-@time)/60) +"min)", -,
	"005 "+$PB_Inquilinos$[4]+" (" +(($PB_Vencimentos[4]-@time)/60) +"min)", -,
	"006 "+$PB_Inquilinos$[5]+" (" +(($PB_Vencimentos[5]-@time)/60) +"min)", -,
	"007 "+$PB_Inquilinos$[6]+" (" +(($PB_Vencimentos[6]-@time)/60) +"min)", -,
	"008 "+$PB_Inquilinos$[7]+" (" +(($PB_Vencimentos[7]-@time)/60) +"min)", -,
	"009 "+$PB_Inquilinos$[8]+" (" +(($PB_Vencimentos[8]-@time)/60) +"min)", -,
	"010 "+$PB_Inquilinos$[9]+" (" +(($PB_Vencimentos[9]-@time)/60) +"min)", -,
	"011 "+$PB_Inquilinos$[10]+" ("+(($PB_Vencimentos[10]-@time)/60)+"min)", -,
	"012 "+$PB_Inquilinos$[11]+" ("+(($PB_Vencimentos[11]-@time)/60)+"min)", -,
	"013 "+$PB_Inquilinos$[12]+" ("+(($PB_Vencimentos[12]-@time)/60)+"min)", -,
	"014 "+$PB_Inquilinos$[13]+" ("+(($PB_Vencimentos[13]-@time)/60)+"min)", -,
	"015 "+$PB_Inquilinos$[14]+" ("+(($PB_Vencimentos[14]-@time)/60)+"min)", -,
	"016 "+$PB_Inquilinos$[15]+" ("+(($PB_Vencimentos[15]-@time)/60)+"min)", -,
	"017 "+$PB_Inquilinos$[16]+" ("+(($PB_Vencimentos[16]-@time)/60)+"min)", -,
	"018 "+$PB_Inquilinos$[17]+" ("+(($PB_Vencimentos[17]-@time)/60)+"min)", -,
	"019 "+$PB_Inquilinos$[18]+" ("+(($PB_Vencimentos[18]-@time)/60)+"min)", -,
	"020 "+$PB_Inquilinos$[19]+" ("+(($PB_Vencimentos[19]-@time)/60)+"min)", -,
	"021 "+$PB_Inquilinos$[20]+" ("+(($PB_Vencimentos[20]-@time)/60)+"min)", -,
	"022 "+$PB_Inquilinos$[21]+" ("+(($PB_Vencimentos[21]-@time)/60)+"min)", -,
	"023 "+$PB_Inquilinos$[22]+" ("+(($PB_Vencimentos[22]-@time)/60)+"min)", -,
	"024 "+$PB_Inquilinos$[23]+" ("+(($PB_Vencimentos[23]-@time)/60)+"min)", -,
	"025 "+$PB_Inquilinos$[24]+" ("+(($PB_Vencimentos[24]-@time)/60)+"min)", -,
	"026 "+$PB_Inquilinos$[25]+" ("+(($PB_Vencimentos[25]-@time)/60)+"min)", -,
	"027 "+$PB_Inquilinos$[26]+" ("+(($PB_Vencimentos[26]-@time)/60)+"min)", -,
	"028 "+$PB_Inquilinos$[27]+" ("+(($PB_Vencimentos[27]-@time)/60)+"min)", -,
	"029 "+$PB_Inquilinos$[28]+" ("+(($PB_Vencimentos[28]-@time)/60)+"min)", -,
	"Ok! Ja vi todos!", _nao_precisa;
goto _testQuarto;

_nao_precisa:
	mes "[Seu Agirrab]";
	mes "Ok! Até a próxima, então!";
close;

//----------------------------------------------------------------------------------------------------------------

_testQuarto:
	set @QuartosSelecionado, @menu-1;
	set @QuartosFormatado$, @QuartosSelecionado+1;
	if(@QuartosSelecionado+1<=9)  set @QuartosFormatado$, "0" + @QuartosFormatado$;
	if(@QuartosSelecionado+1<=99) set @QuartosFormatado$, "0" + @QuartosFormatado$;
	callfunc "getTime";
	if($PB_Inquilinos$[@QuartosSelecionado]!="" && ($PB_Vencimentos[@QuartosSelecionado]-@time)>0) goto _quartoOcupado;
	//mes @QuartosFormatado$+" [Inquilinos="+$PB_Inquilinos$[@QuartosSelecionado]+"] [Vencimento="+ ($PB_Vencimentos[@QuartosSelecionado]-@time) +"]";

	mes "[Seu Agirrab]";
	mes "\"Vai querer alugar este quarto?\"";
	menu
	"Sim! Quero o nº "+@QuartosFormatado$+"!", _quartoAlugar,
	"Talvés! Quero ver a lista novamente!", _listarLocatarios,
	"Não! Desisti de alugar!.", _nao_precisa;
goto _nao_precisa;

_quartoOcupado:
	mes "[Seu Agirrab]";
	mes "\"O quarto nº"+@QuartosFormatado$+" já está alugar para "+$PB_Inquilinos$[@QuartosSelecionado]+".";
	mes "Por favor escolha um quarto vago ou de locação vencida!\"";
	next;
goto _listarLocatarios;

_quartoAlugar:
	//mes "[AgirrabCap="+ Agirrab_Capitulo +"] [Custo="+ $PB_Custo +"] [QuartosOcupados="+ $PB_Ocupados +"]";
	if(zeny < $PB_Custo) goto _sem_grana;
	callfunc "getTime";
	set zeny, zeny - $PB_Custo;
	set $PB_Inquilinos$[@QuartosSelecionado], strcharinfo(0);
	set $PB_Senha$[@QuartosSelecionado], "";
	set $PB_Vencimentos[@QuartosSelecionado], @time + @SegAlugados;
	//set $PB_Ocupados, $PB_Ocupados + 1;
	mes "[Seu Agirrab]";
	mes "\"Pode se dirigir ao quarto nº"+ @QuartosFormatado$ +" que ele ja foi desbloqueado para você!\"";
	next;
	mes "[Seu Agirrab]";
	mes "\"Você pode trocar a senha do quarto pelo lado de dentro!\"";
	next;
	mes "["+ strcharinfo(0) +"]";
	mes "Obrigado!";
close;

_sem_grana:
	mes "[Seu Agirrab]";
	mes "\"Você não tem a grana necessária para isso!\"";
close;

}